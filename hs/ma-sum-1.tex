%!TEX root = tales-main.tex

% (numbers, functions,)
\chapter{The Small, Large, and Infinite}

\section{Introduction}



\section{Numbers}


\section{Communication}

\subsection{Variables}

In the language of math and science, we often use \textbf{variables} to generally indicate the quantities we're talking about. For example, we could say:

\begin{itemize}
\item "Let $v$ be the velocity of this object." % TODO: Finish this up
\end{itemize}

We could also say something like:

\begin{itemize}
\item "Let $a$ and $b$ be the length of the two sides indicated in the right triangle below."
\end{itemize}

% TODO: Insert such a figure


\subsection{Statements}

Often times, these variables will be part of various statements we make. For example, 
\begin{itemize}
\item "For objects of this type, there seems to be a drag force, proportional to $v^2$." 
\end{itemize}

This would be a \textbf{hypothesis}, usually then supported by experiments. 

Alternatively, we could have a statement like:

\begin{itemize}
\item "Let $a$ and $b$ be the length of the two sides indicated in the right triangle below. Then the triangle's area is given by $\frac{1}{2}ab$."
\end{itemize}

This would be more of a mathematical statement, proven true based the properties of area.

\subsubsection{(Experiment vs mathematical statements)}
% TODO

In experimental science, statements often take the form of hypotheses. Then, experiments are conducted in order to provide evidence for or against them.

In mathematics, statements generally have a "truth value" to them.\footnote{TODO: Talk about axioms and stuff?} For example:

\begin{itemize}
\item The statement "3 is greater than 2" (i.e. $3 > 2$) is true. 
\item The statement "6 is a prime number" is false. 
\end{itemize}


\subsection{Operations and other symbols}

We often use other notation in order to get our point across more clearly and/or concisely. 

For example, suppose you wanted to talk about the sum:
\begin{align*}
1 + 2 + 3 + 4 + ... + n
\end{align*}

That sometimes becomes annoying to write. Often, we use the $\sum$ symbol instead (it's a capital Greek letter). It usually indicates the specific range of values we're summing over. % -- for example, $\sum_{i=1}^n (\text{\textit{expression involving i}})$

As an example, we could write the above sum as:
\begin{align*}
\sum_{i=1}^n i
\end{align*}

If we wanted to write the sum
\begin{align*}
6 + 8 + 10 + 12 + 14 + 16 + 18 + 20 + 22 + 24
\end{align*}

we could instead write:
\begin{align*}
\sum_{i=3}^{12} 2i
\end{align*}

There are actually a lot of ways we could have written it, for example:
we could instead write:
\begin{align*}
\sum_{i=5}^{14} 2(i-2)
\end{align*}


We'll encounter a lot more situations like this throughout the rest of the book, where introducing convenient notation will make expressing our ideas easier.

\begin{exercise}
\label{sigma-notation-prac-1}
The sum $12 + 15 + 18 + 21 + 24 + ... + 36 + 39 + 42$ is annoying to write. Can you write it using our "sigma notation" above?
\end{exercise}

\begin{exercise}
\label{sigma-notation-prac-2}
What about the sum $8 + 11 + 14 + 17 + 20 + 23 + 26$?
\end{exercise}
% TODO: Give alternate solutions as well.


%The position of an object, the amount of fluid in a bucket, the concentration of something in something else (say, of oxygen in the air), the force generated by a rocket's engines -- these are all things describable with some combination of numbers and "units" (which tell us "numbers of what"). 

% TODO: Clarify what a reference point is.

%Some fitting examples of such quantities, respectively, could be "5.266 feet to the right of that telephone pole"\footnote{This quantity also has a "reference point". The quantity "5.266 feet" alone wouldn't very useful in describing where our object is.}, "15.2 grams per liter (or 15.2 g/L)", and 7,500,000 pounds.\footnote{Saturn V first stage thrust, \url{https://en.wikipedia.org/wiki/Saturn_V}}

% TODO: Possibly clarify that the telephone pole is a reference point. 
% TODO: That footnote looks an awful lot like a square.  


%Moreover, unlike some other measurements -- such as the number of balls in an urn, or the number of times the word "the" appears in this book -- we can describe our previous quantities with a much greater set of numbers than the "counting numbers" $(1, 2, 3, ...)$. We can't really have 1.6 balls in an urn (even if a ball were cut up, it's not really a "ball" anymore), but it makes sense to have 1.6 liters of fluid in a bucket. We could also have 1.7 liters in that bucket, or pretty much any quantity in between 1.6 and 1.7 liters (1.6333, $\frac{1 + \sqrt{5}}{2}$\footnote{This quantity is called the "golden ratio", and it appears in a lot of interesting places. Look it up!}, etc.) - any such value would make sense here. \footnote{Some of you may be thinking about the fact that fluid is just a bunch of atoms and molecules, and that those aren't really indivisible. But our "infinitely divisible fluid" is a nice approximation for now.}

% TODO: Again, footnotes are numbers. This is annoying and confusing.


\section{Counting numbers}

We'll start our first real mathematical tale by looking at numbers themselves. 

Here, we'll focus on the \textbf{counting numbers}: 1, 2, 3, 4, ... and so on. Practically, they're used to describe the quantity of things that can't really be divided into parts (for example, you can have 1.42 liters of water, but you can't have 1.42 balls in a jar). 

\subsection{Definition}

How can we \emph{define} what we mean by counting numbers? ("Numbers for counting balls" doesn't quite cut it.)

We know that the numbers should be 1, 2, 3, 4, ... and so on. How do we know what the "and so on" should be?

One way is to consider the "order" of the numbers. We know that, in some sense, 7 comes after 6, which comes after 5, which comes after 4, ... 

More precisely, if we have some number $k$, we know that $k+1$ comes after it. 

There's also a number that doesn't "come after" anyone else: The number 1.

Using these facts, let's define the counting numbers as the set (or collection) of numbers which has the following properties:

\begin{itemize}
\item 1 is in the collection.
\item If $k$ is in the collection, then $k+1$ is as well. 
\end{itemize}

\begin{exercise}
The numbers 2, 4, 6, 8, ... are often called the \textbf{even numbers}. Can you define these similarly?
\end{exercise}
% TODO: Present solutions in two ways! the 2*n method, and the one similar to above.


\subsection{The Principle of Mathematical Induction}

Consider the following sums:
\begin{align*}
1 &= 1 \\
1 + 2 &= 3 \\
1 + 2 + 3 &= 6 \\
1 + 2 + 3 + 4 &= 10 \\
1 + 2 + 3 + 4 + 5 &= 15 \\
1 + 2 + 3 + 4 + 5 + 6 &= 21 \\
1 + 2 + 3 + 4 + 5 + 6 + 7 &= 28 \\
\end{align*}
% TODO: Needs better formatting

Or, to use our "sigma notation":
\begin{align*}
\sum_{i=1}^1 i &= 1 \\
\sum_{i=1}^2 i &= 3 \\
\sum_{i=1}^3 i &= 6 \\
\sum_{i=1}^4 i &= 10 \\
\sum_{i=1}^5 i &= 15 \\
\sum_{i=1}^6 i &= 21 \\
\sum_{i=1}^7 i &= 28 \\
\end{align*}

Do you see the pattern? Better yet, can you see a "formula" for getting the sum from 1 to $n$ (in other words, $\sum_{i=1}^n i$) for any "counting number" $n$?

\newpage

I claim that:

\begin{equation}
\label{sum-i}
\sum_{i=1}^n i = \frac{n(n+1)}{2}
\end{equation}

I'd like to prove that this equation is true when $n$ is any counting number. How can I do it? 

Remember how we defined the counting numbers? Well, let's say I instead consider the "collection of numbers for which Equation \ref{sum-i} is true". 

Then suppose I show that Equation \ref{sum-i} is true when $n = 1$ -- in other words, 1 is in this "collection of numbers". Then let's show that, as long as we assume Equation \ref{sum-i} is true when $n = k$ for some value $k$, we can then prove that Equation \ref{sum-i} is true when $n = k + 1$. In other words, if $k$ is in our collection, then $k+1$ is as well.

Do you see where we're going with this? If we show the above true things, then we've shown that the "collection of numbers for which Equation \ref{sum-i} is true" is in fact the counting numbers. In other words, Equation \ref{sum-i} is then true whenever $n$ is a counting number!

\begin{exercise}
Before we go any further, try out Equation \ref{sum-i} for yourself. Plug in 1 through 7 for $n$, and see if you get the answers you expect. 
\end{exercise}

\subsubsection{Proof}

Let's do exactly what we just said.

First, let's see whether our formula is true when $n=1$. On the left side of Equation \ref{sum-i}, we see that 

\begin{align*}
\sum_{i=1}^{1} i = 1
\end{align*}

And on the right side, we see that:
\begin{align*}
\frac{1(1+1)}{2} = \frac{1 \cdot 2}{2} = \frac{2}{2} = 1
\end{align*}

So the statement holds at $n = 1$. Great!

Now for the second part. (We often call this part the \textbf{inductive step}.) Suppose the statement were true at $n = k$. In other words, suppose we knew that, at some value $k$:

\begin{equation*}
\sum_{i=1}^k i = \frac{k(k+1)}{2}
\end{equation*}

Let's try to now prove that the statement is true at $n = k + 1$. In other words, we wish to prove that:
\begin{align*}
\sum_{i=1}^{k+1} i = \frac{(k+1)((k+1)+1)}{2}
\end{align*}

Or, simplifying a bit, we want to prove:
\begin{align*}
\sum_{i=1}^{k+1} i = \frac{(k+1)(k+2)}{2}
\end{align*}

Let's try it! Starting from the left side, we see that:
\begin{align*}
\sum_{i=1}^{k+1} i &= \sum_{i=1}^{k} i + (k+1) && \text{(I'm splitting a term from our sigma-expression. See why it works?)} \\
&= \frac{k(k+1)}{2} + (k+1) && \text{(We're assuming the statement is true at $n=k$, so substitute it in.)} \\
&= \frac{k(k+1)}{2} + \frac{2(k+1)}{2} \\
&= \frac{k(k+1) + 2(k+1)}{2} \\
&= \frac{(k+1)(k+2)}{2} && \text{(Factor out k+1)}\\
\end{align*}

We've done it -- we've shown that, if we assume Equation \ref{sum-i} is true when $n=k$, we've shown that, as a consequence, it must be true for $n = k+1$. 

% TODO: Need some philosophical pondering here / more on why this is exciting
% Also note that this is the "principle of mathematical induction"

\begin{exercise}
\label{sum-i2}
I claim that there is also a nice formula for the sum of $i^2$ from 1 through $n$. Namely:

\begin{equation}
\label{eq:sum-i2}
\sum_{i=1}^{n} i^2 = \frac{n(n+1)(2n+1)}{6}
\end{equation}

Prove that this statement is true whenever $n$ is a counting number, using induction.
\end{exercise}


\section{Counting things}

%This leads us into our second tale of the chapter.

% OLD? TODO: Explain perms/combs
% OLD? Briefly incorporate "sequence" vocal (don't need to formally define it yet)


% maybe should be an "official" subsection?
\subsection{Arranging things}


How many ways can I arrange the letters $a$, $b$, $c$, and $d$?

% Possible TODO: brief lead-in here? (even if it's only half a sentence)
Let's write them out:

\begin{gather*}
(a, b, c, d) \\
(a, b, d, c) \\
(a, c, b, d) \\
(a, c, d, b) \\
(a, d, b, c) \\
(a, d, c, b) \\
(b, a, c, d) \\
(b, a, d, c) \\
(b, c, a, d) \\
(b, c, d, a) \\
(b, d, a, c) \\
(b, d, c, a) \\
(c, a, b, d) \\
(c, a, d, b) \\
(c, b, a, d) \\
(c, b, d, a) \\
(c, d, a, b) \\
(c, d, b, a) \\
(d, a, b, c) \\
(d, a, c, b) \\
(d, b, a, c) \\
(d, b, c, a) \\
(d, c, a, b) \\
(d, c, b, a) \\
\end{gather*}

In case you feel like counting, there are 24 of them.

But writing out all our possibilities is slightly annoying, even with only four letters. (Imagine using more!) We might even have missed some! How could we have figured out how many we have otherwise, perhaps with more confidence? % (more rigorously) 

Hopefully the order in which we wrote the above permutations is a bit revealing. Delving a little deeper, we can divide our arrangements into 4 possibilities:

\begin{enumerate}
\item Those that start with $a$
\item Those that start with $b$
\item Those that start with $c$
\item Those that start with $d$
\end{enumerate}

Let's look at the ones that start with the letter $a$. In each such arrangement, the only letters that can be used for the last three spaces are $b$, $c$, and $d$. 

Similar things happen in the other cases. If we take one of the letters and use it as our first, the last three characters must be taken from the three characters you haven't used yet. (For example, if we use $b$ as our first character, then our last three characters must be an ordering using the letters $a$, $c$, and $d$ in some order.) % Explain better?

This leads us to a really important observation. We have a problem of finding the "number of arrangements of 4 things". We can divide it into 4 separate scenarios (the 4 cases), each of which has a smaller, but very similar problem -- the "number of arrangements of 3 things". 

Let's come up with some better notation. Let $p_n$ denote the "number of arrangements of $n$ things". Our observation is that:

\begin{equation*}
p_4 = 4 \cdot p_3
\end{equation*}

% TODO: need some sort of break here? (maybe just space)

Let's try reducing part of our problem even more. Remember all those arrangements that started with the letter $a$?

\begin{gather*}
(a, b, c, d) \\
(a, b, d, c) \\
(a, c, b, d) \\
(a, c, d, b) \\
(a, d, b, c) \\
(a, d, c, b) \\
\end{gather*}

As we mentioned, they all consist of the letter $a$, followed by each possible ordering using the letters $b$, $c$, and $d$. We list those here:

\begin{gather*}
(b, c, d) \\
(b, d, c) \\
(c, b, d) \\
(c, d, b) \\
(d, b, c) \\
(d, c, b) \\
\end{gather*}

We can now do something very similar to before. Now, there are 3 cases (starting with $b$, $c$, or $d$ -- and in each case, using the remaining 2 letters to form orderings of length 2). Hopefully you agree with the observation that:

\begin{equation*}
p_3 = 3 \cdot p_2
\end{equation*}

% TODO: space/break?

In fact, hopefully you agree with a more general statement: For counting numbers $n$,

\begin{equation*}
p_n = n \cdot p_{n-1}
\end{equation*}

In other words, the number of ways to arrange $n$ distinct letters (or other things) is given by $n$ times the same problem, but for $(n-1)$. 

% TODO: (Maybe here, maybe elsewhere) Discuss how this type of thing is a "recursive relationship" (and relation to induction)

There's a little bit of nuance to consider here. What if $n$ is 1? Then $(n-1)$ is 0, and we haven't considered 0 a counting number. In other words, we need to stop subtracting 1 somewhere.

Similar to our induction, let's consider some sort of "base case". What is $p_1$? If we only have 1 thing, there's really only 1 way to arrange it. Hence, $p_1 = 1$. 

% TODO: Maybe need to revise the original induction section to start at 0, and for any of those inductive relations that involve starting at some number, discuss the process as being equivalent to all integers above (that starting number). 

% TODO: Explain product notation, and then lead to factorial when starting idx is 1. 

% TODO: Footnote or something noting that our "arrangements" are usually called permutations elsewhere.

% TODO: Need to restate recursion and base case together, and give (ideally combined) equation number

\subsubsection{(Handling 0)}

% TODO: Explain how the definition makes sense for n = 0. 
% (May not need to if we revise the induction section, etc to start at 0)


\subsection{(Arrangements of $k$ from $n$)}
% TODO: (Maybe these should all just be unnamed sections, or even just space?)

Let's now consider a slightly different problem. Suppose we still have the letters $a$, $b$, $c$, and $d$ -- but this time, we can only use them to form arrangements that are two letters long.

We could write out all of our possibilities. Here they are:

\begin{gather*}
(a, b) \\
(a, c) \\
(a, d) \\
(b, a) \\
(b, c) \\
(b, d) \\
(c, a) \\
(c, b) \\
(c, d) \\
(d, a) \\
(d, b) \\
(d, c) \\
\end{gather*}

These are slightly easier to list. However, let's do a similar process.

Let $q_{n,k}$ denote the number of ways to make an ordering of length k from n distinct letters (or other things), and let's consider $q_{4,2}$. As before, we have four "groups" of arrangements based on our starting character (again, the 4 cases being those that start with $a$, $b$, $c$, or $d$). Within each of these 4 cases, we then have the problem of selecting an "arrangement of length 1" (in other words, just a character) from the remaining three available characters. Therefore, our observation is that:

\begin{equation*}
q_{4,2} = 4 \cdot q_{3,1}
\end{equation*}

Hopefully, based on a similar line of thinking, you also agree with the general observation that, for enumerating the $k$-length arrangements of $n$ distinct things:

\begin{equation*}
q_{n,k} = n \cdot q_{n-1,k-1}
\end{equation*}

Let's consider what our "base case" will be here. If we have n letters available and a "length 1" ordering, we just choose a letter and have that be our "length-1 ordering". There are of course n letters we can choose from, so we have

% TODO: Need to discuss distinctness somehow (maybe in a footnote, or just later if you get to it)

% TODO: (Some explanation, maybe alluding to induction?)

\begin{equation}
q_{n,k} = \prod_{i=k+1}^n
\end{equation}









\subsection{Collecting things}




\subsection{(Example problem -- balls in urns)}

\subsection{Pascal's triangle}

\subsection{(Binomial expansion)}

% TODO: (Eventually some/more recursion stuff)



\newpage
\section{Problems}

% This will be our "pierce the heavens" problem: a challenge that ideally incorporates a lot of what we've talked about. 
% 
% Things used in this problem:
%	- Recurrence/recursion
%	- Counting permutations with things in btwn (the "balls" exercise)
%	- Summation index shifting, term peeling, (various rules)
%	- Sum of row of pascal's triangle
%	- Commutativity of addition
%	- (Sum of i*2^i)
%	- Replacing n-i with i in sum
\begin{problem}
\label{composition-num-3s}

We'll call the sequence $(x_1, x_2, ..., x_k)$ a \textbf{composition} of $n$ (where $n$ is a counting number) if the numbers in the sequence sum to $n$ -- in other words, if:

\begin{equation*}
\sum_{i=1}^k x_i = n
\end{equation*}

For example, $(1,3,1)$ would be a composition of 5.

\begin{enumerate}[(a)]
\item How many compositions of $n$ of length $k$ are there, if we can only use nonnegative numbers? % Hint: Balls
\item How many compositions of $n$ of length $k$ are there, if we can only use positive numbers? % Hint: Consider (x_i - 1) for all i
\item How many compositions of $n$ are there in total, using positive numbers? % Hint: Pascal's triangle
\end{enumerate}

Here's a weird question: If I look at all of the positive-number compositions of $n$, how many times will I see the number 3? (Let's call this count $N(n)$.)

\begin{enumerate}[(a)]
\setcounter{enumi}{3}
\item What are $N(1)$, $N(2)$, and $N(3)$?
\item I claim that, if $n \geq 4$, then $N(n) = n2^{n-5}$. Prove this claim. 
\end{enumerate}

% I claim that, if I take $n \geq 4$, and look at every composition of $n$, I will see the number 3 exactly $n2^{n-5}$ times.



\end{problem}


\newpage
\section{Terms and References}

\section{Hints}

\newpage
\section{Solutions}

\subsection{Exercise \ref{sum-i2}}

% Note: This will be one of the first major exercises. Make sure the solution is detailed.

We're hoping to prove that:
\begin{align*}
\sum_{i=1}^{n} i^2 = \frac{n(n+1)(2n+1)}{6}
\end{align*}

First, let's see whether this statement is true at $n = 1$. On the left side, we see that:
\begin{align*}
\sum_{i=1}^{1} i^2 = 1^2 = 1
\end{align*}

And on the right side, we see that:
\begin{align*}
\frac{1(1+1)(2 \cdot 1+1)}{6} = \frac{1 \cdot 2 \cdot 3}{6} = \frac{6}{6} = 1
\end{align*}

So the statement holds at $n = 1$. Great!


Now for our "inductive step". Suppose the statement were true at $n = k$. In other words, suppose we knew that:
\begin{align*}
\sum_{i=1}^{k} i^2 = \frac{k(k+1)(2k+1)}{6}
\end{align*}

Let's try to now prove that the statement is true at $n = k + 1$. In other words, we wish to prove that:
\begin{align*}
\sum_{i=1}^{k+1} i^2 = \frac{(k+1)((k+1)+1)(2(k+1)+1)}{6}
\end{align*}

(Simplify)

\begin{align*}
\sum_{i=1}^{k+1} i^2 = \frac{(k+1)(k+2)(2k+3)}{6}
\end{align*}

(Work)

\begin{align*}
\sum_{i=1}^{k+1} i^2 &= \sum_{i=1}^{k} i^2 + (k+1)^2 \\
&= \frac{k(k+1)(2k+1)}{6} + (k+1)^2 && \text{(Using our "inductive assumption" that the statement is true at $n = k$)} \\
&= \frac{k(k+1)(2k+1) + 6(k+1)^2}{6} && \text{(Combine fractions)} \\
&= \frac{(k+1)\left[k(2k+1) + 6(k+1)\right]}{6} && \text{(Factor out $k+1$)} \\
&= \frac{(k+1)(2k^2 + k + 6k + 6)}{6} && \text{(Expand terms)} \\
&= \frac{(k+1)(2k^2 + 7k + 6)}{6} && \text{(Combine terms)} \\
&= \frac{(k+1)(k+2)(2k+3)}{6} && \text{(Factor)} \\
\end{align*}

Great! If the statement is true at $n = k$, then it is also true when $n = k + 1$. 

So "by induction", our statement is true when $n$ is any of the counting numbers. $\square$

\subsection{Problem \ref{composition-num-3s}}

As in our problem, let $N(n)$ be the number of times we see 3 in the compositions of $n$. 

Ideally, we'd like to find a recurrence relation for $N(n)$ -- that way, we could hopefully give an induction proof, or at least find some way to take advantage of our recursion. We'll do this, but first some preliminary work.

\subsubsection{A new term}

Let $N_k(n)$ be the number of times we see 3 among compositions \emph{of length $k$}. The number of times we'll see 3 in total is simply the sum of times over all lengths $k$ -- in other words:

\begin{equation*}
N(n) = \sum_{k=1}^{n} N_k(n)
\end{equation*}

Two key observations let us simplify this a bit:

\begin{itemize}
\item We won't see a 3 in any composition of length $n$, because the only such composition is (1, 1, 1, ..., 1) -- essentially $n$ 1s. Therefore, $N_n(n) = 0$ for all counting numbers $n$.
\begin{itemize}
\item For similar reasons, it also follows that $N_k(n) = 0$ whenever $k \geq n$, because for $k > n$, there are no positive-number compositions at all of length $k$ for $n$. (This isn't relevant in this section, but will be important later.)
\end{itemize}
\item If $n \geq 4$, then we won't see a 3 in any composition of length $1$, because the only such composition consists of $n$ itself -- and if $n \geq 4$, then $n \neq 3$. Therefore, $N_1(n)$ = 0. 
\end{itemize}

So simplifying the above equation gives:
\begin{align*}
N(n) &= \sum_{k=1}^{n} N_k(n) \\
&= N_1(n) + \sum_{k=2}^{n-1} N_k(n) + N_n(n) \\
&= 0 + \sum_{k=2}^{n-1} N_k(n) + 0 \\
\end{align*}

and therefore, for $n \geq 4$,

\begin{equation}
\label{composition-num-3s-n-nk}
N(n) = \sum_{k=2}^{n-1} N_k(n)
\end{equation}

\subsubsection{Recurrence on $N_k(n)$}

Instead of constructing a recurrence relation for $N(n)$ immediately, we'll first construct a recurrence relation for $N_k(n)$. Therefore, we'll be looking at sequences of the form $(x_1, x_2, ..., x_k)$ whose terms sum to $n$.

We'll establish this relation for $k \geq 2$ and $n \geq 4$. The base cases (some of which have been discussed directly or indirectly) are:

\begin{align*}
N_k(n) &= 0 \quad \text{for all $k$, when } n \leq 2 \\
N_1(n) &= 0 \quad \text{when } n \geq 4 \\
N_1(3) &= 1 \\
N_2(3) &= 0 \\
N_k(n) &= 0 \quad \text{when } k \geq n \\
\end{align*}

We'll split up our counting into two parts:
\begin{enumerate}
\item How many 3s we see among the first terms (i.e. all the $x_1$s of our compositions)
\item How many 3s there are in the compositions of the form $(x_2, ..., x_k)$ -- in other words, the compositions from before, with the first terms chopped off.
\end{enumerate}

We'll count the latter first. In each composition of $n$, the first term $x_1$ could be any value of $i$ from 1 through $n$. However, since $k \geq 2$, we cannot have $x_1 = n$ (since $x_2, ..., x_k$ would then all have to be 0, and we are only using positive numbers in our composition). 

So $x_1$ could be any value of $i$ from 1 through $(n-1)$. In each such case, the sequence $(x_2, ..., x_k)$ would now be a composition of $(n-i)$, of length $(k-1)$. The number of 3s seen collectively among these compositions would be $N_{k-1}(n-i)$, and we sum over all $i$ to get their total contribution.

We now count the former, i.e. the number of 3s we see in the $x_1$s. (This occurs when $i = 3$ in the above case.) We now know that we'll gain one 3 from each of these compositions. 

Now the number of such compositions $(x_1, x_2, ..., x_k)$, where $x_1 = 3$, is simply given by the number of compositions $(x_2, ..., x_k)$ of $(n-3)$ (and as before, of length $(k-1)$). 

How many of these are there? From part (b), the number of compositions of $n$ of length $k$ is $\binom{n-1}{k-1}$. Therefore, substituting our actual values gives $\binom{(n-3)-1}{(k-1)-1} = \binom{n-4}{k-2}$ such compositions. Since each of these compositions will give us one 3 in the $x_1$ term, we'll gain $\binom{n-4}{k-2}$ 3s.

Combining all of this information gives us a recurrence relation:

\begin{equation} 
\label{composition-num-3s-nk-recurrence}
N_k(n) = \binom{n-4}{k-2} + \sum_{i=1}^{n-1} N_{k-1}(n-i)
\end{equation}


\subsubsection{Recurrence on $N(n)$}

Now that we have something for $N_k(n)$, let's see what we can do with $N(n)$. 

Starting from Equation \ref{composition-num-3s-n-nk}, we have:

\begin{align*}
N(n) &= \sum_{k=2}^{n-1} N_k(n) \\
&= \sum_{k=2}^{n-1} \left( \binom{n-4}{k-2} + \sum_{i=1}^{n-1} N_{k-1}(n-i) \right) && \text{(Equation \ref{composition-num-3s-nk-recurrence})} \\
&= \sum_{k=2}^{n-1} \left( \binom{n-4}{k-2} + \sum_{i=1}^{n-1} N_{k-1}(i) \right) && \text{(Exercise \ref{TODO-sum-i-ni})} \\
&= \sum_{k=2}^{n-1} \binom{n-4}{k-2} + \sum_{k=2}^{n-1} \sum_{i=1}^{n-1} N_{k-1}(i) \\
&= \sum_{k=0}^{n-3} \binom{n-4}{k} + \sum_{k=2}^{n-1} \sum_{i=1}^{n-1} N_{k-1}(i) && \text{(Shift index)} \\
&= \sum_{k=0}^{n-4} \binom{n-4}{k} + \binom{n-4}{n-3} + \sum_{k=2}^{n-1} \sum_{i=1}^{n-1} N_{k-1}(i) \\
&= 2^{n-4} + \binom{n-4}{n-3} + \sum_{k=2}^{n-1} \sum_{i=1}^{n-1} N_{k-1}(i) && \text{(Sum of row in Pascal's triangle)} \\
&= 2^{n-4} + \sum_{k=2}^{n-1} \sum_{i=1}^{n-1} N_{k-1}(i) && \text{(Binomial coefficient defn -- term is 0)} \\
&= 2^{n-4} + \sum_{i=1}^{n-1} \sum_{k=2}^{n-1} N_{k-1}(i) && \text{(Commutativity of addition!)} \\
&= 2^{n-4} + \sum_{i=1}^{n-1} \sum_{k=1}^{n-2} N_{k}(i) && \text{(Shift index)}
\end{align*}

% TODO: Possible philosophizing on the commutativity trick

At this point, we want to make sure we handle our base cases correctly, since there's a lot going on. Continuing, we have:

\begin{align*}
N(n) &= 2^{n-4} + \sum_{i=1}^{n-1} \sum_{k=1}^{n-2} N_{k}(i) \\
&= 2^{n-4} + \sum_{k=1}^{n-2} N_{k}(1) + \sum_{k=1}^{n-2} N_{k}(2) + \sum_{k=1}^{n-2} N_{k}(3) + \sum_{i=4}^{n-1} \sum_{k=1}^{n-2} N_{k}(i) && \text{(Split off $i = 1,2,3$ terms)} \\
&= 2^{n-4} + 0 + 0 + \sum_{k=1}^{n-2} N_{k}(3) + \sum_{i=4}^{n-1} \sum_{k=1}^{n-2} N_{k}(i) && \text{(Base case for $n \leq 2$)} \\
&= 2^{n-4} + \sum_{k=1}^{n-2} N_{k}(3) + \sum_{i=4}^{n-1} \sum_{k=1}^{n-2} N_{k}(i) \\
&= 2^{n-4} + N_1(3) + N_2(3) + N_3(3) + \sum_{k=4}^{n-2} N_{k}(3) + \sum_{i=4}^{n-1} \sum_{k=1}^{n-2} N_{k}(i) \\
&= 2^{n-4} + 1 + 0 + 0 + 0 + \sum_{i=4}^{n-1} \sum_{k=1}^{n-2} N_{k}(i) && \text{(Last 3 base cases)} \\
&= 2^{n-4} + 1 + \sum_{i=4}^{n-1} \sum_{k=1}^{n-2} N_{k}(i) \\
&= 2^{n-4} + 1 + \sum_{i=4}^{n-1} \sum_{k=2}^{n-2} N_{k}(i) && \text{($N_1(i) = 0$ for  $i \geq 4$)} \\
&= 2^{n-4} + 1 + \sum_{i=4}^{n-1} \left( \sum_{k=2}^{i-1} N_{k}(i) + \sum_{k=i}^{n-2} N_{k}(i) \right) && \text{(Split sum)} \\
&= 2^{n-4} + 1 + \sum_{i=4}^{n-1} \sum_{k=2}^{i-1} N_{k}(i) && \text{($N_{k}(i) = 0$ for  $k \geq i$)} \\
&= 2^{n-4} + 1 + \sum_{i=4}^{n-1} N(i) && \text{(Equation \ref{composition-num-3s-n-nk} again!)} \\
\end{align*}

This is promising -- we now have a recurrence relation for $N(n)$ itself! (In fact, it looks sort of like that from Exercise \ref{TODO-strong-induction-sequence}. 


\subsubsection{Induction}

We now proceed to the final part of our proof. A reminder of what we want to prove: if $n \geq 4$, then $N(n) = n2^{n-5}$.

We'll use strong induction. For our base case at $n = 4$, we simply go through all compositions. They are:
\begin{gather*}
(1, 1, 1, 1) \\
(2, 1, 1) \\
(1, 2, 1) \\
(1, 1, 2) \\
(2, 2) \\
(1, 3) \\
(3, 1) \\
(4)
\end{gather*}

This gives us 2 3s. And at $n = 4$,
\begin{equation*}
n2^{n-5} = 4 \cdot 2^{4-5} = 4 \cdot 2^{-1} = 2
\end{equation*}

So the base case is true.

We then prove the strong inductive step, proving that the statement is true at $n$, assuming the statement is true for values $4, 5, ..., (n-1)$:\footnote{It's slightly different here to be working with $n$ directly (as opposed to having another placeholder variable), but hopefully you agree this is valid.}

\begin{align*}
N(n) &= 2^{n-4} + 1 + \sum_{i=4}^{n-1} N(i) \\
&= 2^{n-4} + 1 + \sum_{i=4}^{n-1} i2^{i-5} && \text{(Strong inductive assumption)} \\
&= 2^{n-4} + 1 + 2^{-5} \sum_{i=4}^{n-1} i2^{i} \\
&= 2^{n-4} + 1 + 2^{-5} \left(\sum_{i=1}^{n-1} i2^{i} - \left( 3 \cdot 2^3 + 2 \cdot 2^2 + 1 \cdot 2^1 \right) \right) \\
&= 2^{n-4} + 1 + 2^{-5} \left(\sum_{i=1}^{n-1} i2^{i} - (24 + 8 + 2) \right) \\
&= 2^{n-4} + 1 + 2^{-5} \left(2 + 2^{(n-1)+1}((n-1)-1) - (24 + 8 + 2) \right) \\
&= 2^{n-4} + 1 + 2^{-5} \left(2 + 2^{n}(n-2) - (24 + 8 + 2) \right) \\
&= 2^{n-4} + 1 + 2^{-5} \left(2^{n}(n-2) - (24 + 8) \right) \\
&= 2^{n-4} + 1 + 2^{-5} \left(2^{n}(n-2) - 2^5 \right) \\
&= 2^{n-4} + 1 + 2^{n-5}(n-2) - 1 \\
&= 2^{n-4} + 2^{n-5}(n-2) \\
&= 2^{n-4} + n2^{n-5} - 2 \cdot 2^{n-5} \\
&= 2^{n-4} + n2^{n-5} - 2^{n-4} \\
&= n2^{n-5}
\end{align*}

Hence, our strong inductive step holds, and therefore our statement holds: for $n \geq 4$, $N(n) = n2^{n-5}$. $\square$

